# éƒ¨ç½²æ£€æŸ¥æ¸…å•

## éƒ¨ç½²å‰æ£€æŸ¥

### âœ… ç¯å¢ƒå‡†å¤‡
- [ ] Node.js å·²å®‰è£… (v16+)
- [ ] å·²å®‰è£… Wrangler CLI: `npm install -g wrangler`
- [ ] å·²ç™»å½• Cloudflare: `wrangler login`
- [ ] å·²å®‰è£…é¡¹ç›®ä¾èµ–: `npm install`

### âœ… æ•°æ®åº“é…ç½®
- [ ] å·²åˆ›å»º D1 æ•°æ®åº“: `wrangler d1 create cet6_vocabulary`
- [ ] å·²åœ¨ `wrangler.toml` ä¸­é…ç½® `database_id`
- [ ] å·²æ‰§è¡Œæ•°æ®åº“åˆå§‹åŒ–: `npm run init-db`
- [ ] éªŒè¯è¡¨ç»“æ„å·²åˆ›å»º:
  ```bash
  wrangler d1 execute cet6_vocabulary --command="SELECT name FROM sqlite_master WHERE type='table'"
  ```

### âœ… æœ¬åœ°æµ‹è¯•
- [ ] æœ¬åœ°å¼€å‘æœåŠ¡å™¨å¯ä»¥å¯åŠ¨: `npm run dev`
- [ ] æˆåŠŸå¯¼å…¥å•è¯æ•°æ®: `node scripts/init-data.js`
- [ ] æ‰€æœ‰æµ‹è¯•é€šè¿‡: `node test/test.js`

### âœ… ä»£ç æ£€æŸ¥
- [ ] TypeScript ç¼–è¯‘æ— é”™è¯¯: `npm run build`
- [ ] æ‰€æœ‰APIæ¥å£å·²å®ç°
- [ ] CORS é…ç½®æ­£ç¡®
- [ ] é”™è¯¯å¤„ç†å®Œå–„

## éƒ¨ç½²æ­¥éª¤

### 1. é¦–æ¬¡éƒ¨ç½²
```bash
npm run deploy
```

### 2. è·å–éƒ¨ç½²URL
éƒ¨ç½²æˆåŠŸåï¼Œä½ ä¼šçœ‹åˆ°ç±»ä¼¼è¾“å‡ºï¼š
```
Published cet6-vocabulary-backend (x.xx sec)
  https://cet6-vocabulary-backend.your-subdomain.workers.dev
```

### 3. è¿œç¨‹å¯¼å…¥æ•°æ®
æ›´æ–° `scripts/init-data.js` ä¸­çš„ `WORKER_URL` ä¸ºéƒ¨ç½²çš„URLï¼Œç„¶åè¿è¡Œï¼š
```bash
node scripts/init-data.js
```

### 4. éªŒè¯éƒ¨ç½²
```bash
# æµ‹è¯•æ³¨å†Œæ¥å£
curl -X POST https://your-worker.workers.dev/api/user/register \
  -H "Content-Type: application/json" \
  -d '{"deviceId":"test-device"}'
```

## éƒ¨ç½²åé…ç½®

### âœ… å®‰å…¨é…ç½®
- [ ] è€ƒè™‘ç§»é™¤ `/api/init` æ¥å£ï¼ˆæˆ–æ·»åŠ è®¤è¯ï¼‰
- [ ] åœ¨ `src/index.ts` ä¸­æ›´æ–° CORS é…ç½®ï¼Œé™åˆ¶ç‰¹å®šåŸŸå
  ```typescript
  'Access-Control-Allow-Origin': 'https://your-frontend-domain.com'
  ```
- [ ] åœ¨ Cloudflare Dashboard é…ç½® Rate Limiting

### âœ… ç›‘æ§é…ç½®
- [ ] åœ¨ Cloudflare Dashboard å¯ç”¨æ—¥å¿—
- [ ] è®¾ç½®å‘Šè­¦è§„åˆ™
- [ ] é…ç½®æ€§èƒ½ç›‘æ§

### âœ… åŸŸåé…ç½®ï¼ˆå¯é€‰ï¼‰
- [ ] åœ¨ Cloudflare æ·»åŠ è‡ªå®šä¹‰åŸŸå
- [ ] é…ç½® SSL/TLS
- [ ] æ›´æ–°å‰ç«¯ä»£ç ä¸­çš„ API åœ°å€

## æµ‹è¯•æ¸…å•

### åŠŸèƒ½æµ‹è¯•
- [ ] ç”¨æˆ·æ³¨å†ŒåŠŸèƒ½
- [ ] ç”¨æˆ·ç»Ÿè®¡æŸ¥è¯¢
- [ ] å­¦ä¹ å•è¯è·å–
- [ ] å­¦ä¹ ç»“æœæäº¤
- [ ] å¤ä¹ å•è¯è·å–
- [ ] å¤ä¹ å®ŒæˆåŠŸèƒ½

### æ€§èƒ½æµ‹è¯•
- [ ] å•è¯æŸ¥è¯¢é€Ÿåº¦ < 100ms
- [ ] å¹¶å‘ç”¨æˆ·æ”¯æŒ
- [ ] æ•°æ®åº“ç´¢å¼•ä¼˜åŒ–éªŒè¯

### è¾¹ç•Œæµ‹è¯•
- [ ] æ— æ•ˆ userId å¤„ç†
- [ ] ç©ºå•è¯åˆ—è¡¨å¤„ç†
- [ ] é‡å¤æäº¤å¤„ç†
- [ ] å¤§é‡ç”¨æˆ·åœºæ™¯

## å¸¸è§é—®é¢˜æ’æŸ¥

### é—®é¢˜1: éƒ¨ç½²æˆåŠŸä½†è®¿é—®404
**è§£å†³æ–¹æ¡ˆ**:
- æ£€æŸ¥è·¯ç”±è·¯å¾„æ˜¯å¦æ­£ç¡®
- ç¡®è®¤ wrangler.toml é…ç½®æ­£ç¡®
- æŸ¥çœ‹ Worker æ—¥å¿—: `wrangler tail`

### é—®é¢˜2: æ•°æ®åº“æŸ¥è¯¢å¤±è´¥
**è§£å†³æ–¹æ¡ˆ**:
- ç¡®è®¤ database_id é…ç½®æ­£ç¡®
- æ£€æŸ¥æ•°æ®åº“æ˜¯å¦å·²åˆå§‹åŒ–
- éªŒè¯è¡¨ç»“æ„: 
  ```bash
  wrangler d1 execute cet6_vocabulary --command="SELECT * FROM vocabulary LIMIT 1"
  ```

### é—®é¢˜3: CORS é”™è¯¯
**è§£å†³æ–¹æ¡ˆ**:
- æ£€æŸ¥ handleCORS å‡½æ•°
- ç¡®è®¤å‰ç«¯è¯·æ±‚å¤´æ­£ç¡®
- éªŒè¯ OPTIONS è¯·æ±‚å¤„ç†

### é—®é¢˜4: æ€§èƒ½æ…¢
**è§£å†³æ–¹æ¡ˆ**:
- æ£€æŸ¥ç´¢å¼•æ˜¯å¦åˆ›å»º
- æŸ¥çœ‹ D1 æŸ¥è¯¢è®¡åˆ’
- ä¼˜åŒ–æŸ¥è¯¢è¯­å¥

## æ•°æ®å¤‡ä»½

### å®šæœŸå¤‡ä»½ï¼ˆæ¨èæ¯å‘¨ï¼‰
```bash
# å¯¼å‡ºæ•°æ®
wrangler d1 export cet6_vocabulary --output=backup-$(date +%Y%m%d).sql

# å¯¼å‡ºç”¨æˆ·æ•°æ®
wrangler d1 execute cet6_vocabulary --command="SELECT * FROM users" --json > users-backup.json
```

### æ¢å¤æ•°æ®
```bash
wrangler d1 execute cet6_vocabulary --file=backup-20251027.sql
```

## ç‰ˆæœ¬æ›´æ–°

### æ›´æ–°ä»£ç 
```bash
# 1. ä¿®æ”¹ä»£ç 
# 2. æœ¬åœ°æµ‹è¯•
npm run dev

# 3. éƒ¨ç½²æ–°ç‰ˆæœ¬
npm run deploy

# 4. ç›‘æ§æ—¥å¿—
wrangler tail
```

### å›æ»š
å¦‚æœæ–°ç‰ˆæœ¬æœ‰é—®é¢˜ï¼Œåœ¨ Cloudflare Dashboard:
1. è¿›å…¥ Workers & Pages
2. é€‰æ‹©ä½ çš„ Worker
3. ç‚¹å‡» "Deployments"
4. é€‰æ‹©ä¹‹å‰çš„ç‰ˆæœ¬ç‚¹å‡» "Rollback"

## ç›‘æ§æŒ‡æ ‡

### å…³é”®æŒ‡æ ‡
- **è¯·æ±‚æˆåŠŸç‡**: > 99.9%
- **å¹³å‡å“åº”æ—¶é—´**: < 200ms
- **P95 å“åº”æ—¶é—´**: < 500ms
- **é”™è¯¯ç‡**: < 0.1%
- **D1 æŸ¥è¯¢æ—¶é—´**: < 100ms

### æŸ¥çœ‹æ–¹å¼
1. Cloudflare Dashboard
2. Workers & Pages > ä½ çš„Worker > Metrics
3. æˆ–ä½¿ç”¨ Cloudflare Analytics API

## æˆæœ¬ä¼°ç®—

### Cloudflare Workers å…è´¹é¢åº¦
- è¯·æ±‚: 100,000 æ¬¡/å¤©
- CPU æ—¶é—´: 10ms/è¯·æ±‚
- D1 å­˜å‚¨: 5GB
- D1 è¯»å–: 5,000,000 æ¬¡/å¤©
- D1 å†™å…¥: 100,000 æ¬¡/å¤©

### é¢„è®¡æˆæœ¬ï¼ˆ1000æ—¥æ´»ç”¨æˆ·ï¼‰
- æ¯ç”¨æˆ·æ¯å¤©çº¦ 20 æ¬¡è¯·æ±‚
- æ€»è¯·æ±‚: 20,000 æ¬¡/å¤©
- å®Œå…¨åœ¨å…è´¹é¢åº¦å†… âœ…

## å®Œæˆç¡®è®¤

éƒ¨ç½²å®Œæˆåï¼Œç¡®è®¤ä»¥ä¸‹å†…å®¹ï¼š

- [ ] âœ… Worker å¯ä»¥æ­£å¸¸è®¿é—®
- [ ] âœ… æ‰€æœ‰ API æ¥å£å“åº”æ­£å¸¸
- [ ] âœ… æ•°æ®åº“åŒ…å«å®Œæ•´å•è¯æ•°æ®
- [ ] âœ… æµ‹è¯•ç”¨æˆ·å¯ä»¥æ­£å¸¸å­¦ä¹ 
- [ ] âœ… å¤ä¹ åŠŸèƒ½æ­£å¸¸å·¥ä½œ
- [ ] âœ… æ—¥å¿—å’Œç›‘æ§å·²é…ç½®
- [ ] âœ… å¤‡ä»½è®¡åˆ’å·²è®¾ç½®

---

**æ­å–œï¼ä½ çš„å…­çº§å•è¯åˆ·è¯è½¯ä»¶åç«¯å·²æˆåŠŸéƒ¨ç½²ï¼** ğŸ‰

ä¸‹ä¸€æ­¥ï¼šå¼€å‘å‰ç«¯åº”ç”¨ï¼Œè¿æ¥åˆ°æ­¤åç«¯APIã€‚
